package org.wanghailu.detector.test;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;
import org.wanghailu.detector.model.MethodRule;
import org.wanghailu.detector.util.SerializeUtils;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @author cdhuang
 * @date 2023/6/12
 */
public class RuleConfigTest {
    
    
    @Test
    public void test() throws Exception {
        //污点源
        String config = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1449, \"rule_type_id\": 76, \"rule_type\": \"Struts2\\u63a5\\u53e3\\u8bfb\\u53d6\\u53c2\\u6570\", \"value\": \"org.apache.struts2.dispatcher.multipart.MultiPartRequest.getParameterValues(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1618796536, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1459, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getInputStream()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522113, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1460, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getParameter(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522239, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1461, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getParameterNames()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522255, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1462, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getParameterValues(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522275, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1463, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getParameterMap()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522288, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1464, \"rule_type_id\": 102, \"rule_type\": \"ServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.ServletRequest.getReader()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622522303, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1465, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getHeader(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622524240, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1466, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getHeaderNames()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622524294, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1467, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getParts()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622524335, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1468, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getPart(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622524349, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1469, \"rule_type_id\": 104, \"rule_type\": \"Spring\\u53c2\\u6570\\u5904\\u7406\\u63a5\\u53e3\", \"value\": \"org.springframework.web.method.support.HandlerMethodArgumentResolver.resolveArgument(org.springframework.core.MethodParameter,org.springframework.web.method.support.ModelAndViewContainer,org.springframework.web.context.request.NativeWebRequest,org.springframework.web.bind.support.WebDataBinderFactory)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622524675, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1470, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getCookies()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622528104, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1471, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getHeaders(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622528147, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1472, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getQueryString()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1622528180, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1473, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getInputStream()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450208, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1474, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getParameter(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450230, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1475, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getParameterNames()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450243, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1476, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getParameterValues(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450258, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1477, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getParameterMap()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450274, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1478, \"rule_type_id\": 103, \"rule_type\": \"HttpServletRequest\\u63a5\\u53e3\", \"value\": \"javax.servlet.http.HttpServletRequest.getReader()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"false\", \"update_time\": 1624450293, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 22, \"num_pages\": 1, \"page_size\": 50}}";
        
        //base64编解码
        String config2 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1057, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"java.util.Base64$Decoder.decode(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1058, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"java.util.Base64$Decoder.decode(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1059, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"java.util.Base64$Decoder.decode(java.nio.ByteBuffer)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1060, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"java.util.Base64$Decoder.decode(byte[],byte[])\", \"source\": \"P1\", \"target\": \"P2\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1061, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.decodeBase64(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1062, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.decodeBase64(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1063, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.decodeInteger(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1064, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.decode(java.lang.Object)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1065, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.decode(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1066, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.decode(java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1067, \"rule_type_id\": 21, \"rule_type\": \"BASE64\\u89e3\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.decode(byte[],int,int,org.apache.commons.codec.binary.BaseNCodec$Context)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 11, \"num_pages\": 1, \"page_size\": 30}}";
        
        String config3 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1068, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"java.util.Base64$Encoder.encode(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1069, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"java.util.Base64$Encoder.encodeToString(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1070, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"java.util.Base64$Encoder.encode(java.nio.ByteBuffer)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1071, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"java.util.Base64$Encoder.encode(byte[],byte[])\", \"source\": \"P1\", \"target\": \"P2\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1072, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.encode(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1073, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.encode(byte[],int,int)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1074, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.encode(java.lang.Object)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1075, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.encodeAsString(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1076, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.BaseNCodec.encodeToString(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1077, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.encodeBase64(byte[])\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1078, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.encodeBase64(byte[],boolean)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1079, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.encodeBase64(byte[],boolean,boolean)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1080, \"rule_type_id\": 22, \"rule_type\": \"BASE64\\u7f16\\u7801\", \"value\": \"org.apache.commons.codec.binary.Base64.encodeBase64(byte[],boolean,boolean,int)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 13, \"num_pages\": 1, \"page_size\": 20}}";
        
        //字符串实例化
        String config4 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 986, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.replace(int,int,java.lang.String)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 987, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.toString()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 988, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 989, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.<init>(java.lang.CharSequence)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 990, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(java.lang.Object)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 991, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 992, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(java.lang.StringBuffer)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 993, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(java.lang.CharSequence)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 994, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(java.lang.CharSequence,int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 995, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.append(char[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1456, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.delete(int,int)\", \"source\": \"O\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618827778, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1487, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"com.github.pagehelper.parser.CountSqlParser.getSmartCountSql(java.lang.String,java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1635475796, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1511, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.substring(int,int)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1641455266, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1512, \"rule_type_id\": 2, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-02\", \"value\": \"java.lang.StringBuilder.getChars(int,int,char[],int)\", \"source\": \"O\", \"target\": \"P3\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1641455703, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 14, \"num_pages\": 1, \"page_size\": 20}}";
        
        String config5 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 961, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 962, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(java.lang.StringBuffer)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 963, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(java.lang.StringBuilder)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 964, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(byte[])\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 965, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(byte[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 966, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(byte[],int,int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 967, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(byte[],int,int,java.nio.charset.Charset)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 968, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(byte[],int,int,java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 969, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(char[])\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 970, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(char[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 971, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.replace(java.lang.CharSequence,java.lang.CharSequence)\", \"source\": \"P2\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 972, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.toLowerCase(java.util.Locale)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 973, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.toUpperCase(java.util.Locale)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 974, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getBytes()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 975, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getBytes(java.lang.String)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 976, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getBytes(java.nio.charset.Charset)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 977, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getBytes(int,int,byte[],int)\", \"source\": \"O\", \"target\": \"P3\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 978, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getChars(int,int,char[],int)\", \"source\": \"O\", \"target\": \"P3\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536826, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 979, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.concat(java.lang.String)\", \"source\": \"O|P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 980, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.substring(int,int)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 981, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.substring(int)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 982, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.toCharArray()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 983, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.<init>(char[],int,int,boolean)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 984, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.split(java.lang.String)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 985, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.split(java.lang.String, int)\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1453, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringUTF16.newString(byte[],int,int)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618827358, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1454, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringLatin1.newString(byte[],int,int)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618827438, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1455, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringConcatHelper.newString(byte[],int,byte)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618827508, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1457, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringConcatHelper.prepend(int,byte[],byte,java.lang.String)\", \"source\": \"P4\", \"target\": \"P2\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618893712, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1458, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.getBytes(byte[],int,byte)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1618893644, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1485, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringConcatHelper.newString(byte[],long)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1635410554, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1486, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.StringConcatHelper.prepend(long,byte[],byte,java.lang.String)\", \"source\": \"P4\", \"target\": \"P2\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1635410695, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1502, \"rule_type_id\": 1, \"rule_type\": \"\\u5b57\\u7b26\\u4e32\\u4f20\\u64ad-01\", \"value\": \"java.lang.String.valueOf(java.lang.Object)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"false\", \"update_time\": 1636721551, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 33, \"num_pages\": 1, \"page_size\": 50}}";
        
        //servlet-stream传播
        String config6 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1139, \"rule_type_id\": 35, \"rule_type\": \"serverlt-stream\\u4f20\\u64ad\", \"value\": \"org.apache.catalina.connector.CoyoteInputStream.read(byte[])\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536831, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1140, \"rule_type_id\": 35, \"rule_type\": \"serverlt-stream\\u4f20\\u64ad\", \"value\": \"org.apache.catalina.connector.CoyoteInputStream.read(byte[],int,int)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536831, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1141, \"rule_type_id\": 35, \"rule_type\": \"serverlt-stream\\u4f20\\u64ad\", \"value\": \"org.apache.catalina.connector.CoyoteInputStream.read(java.nio.ByteBuffer)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536831, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 3, \"num_pages\": 1, \"page_size\": 10}}";
        
        //Cookie传播
        String config7 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1051, \"rule_type_id\": 19, \"rule_type\": \"Cookie\\u4f20\\u64ad\", \"value\": \"javax.servlet.http.Cookie.getValue()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1052, \"rule_type_id\": 19, \"rule_type\": \"Cookie\\u4f20\\u64ad\", \"value\": \"javax.servlet.http.Cookie.<init>(java.lang.String,java.lang.String)\", \"source\": \"P1,2\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536829, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 2, \"num_pages\": 1, \"page_size\": 10}}";
        
        //List传播
        String config8 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 996, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.<init>(java.util.Collection)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 997, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.add(int,java.lang.Object)\", \"source\": \"P2\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 998, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.add(java.lang.Object)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 999, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.addAll(int,java.util.Collection)\", \"source\": \"P2\", \"target\": \"P2\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1000, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.addAll(java.util.Collection)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1001, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.set(int,java.lang.Object)\", \"source\": \"P2\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1002, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.get(int)\", \"source\": \"O&R\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1003, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.clone()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1004, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.toArray()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1005, \"rule_type_id\": 3, \"rule_type\": \"List\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.List.toArray(java.lang.Object[])\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 10, \"num_pages\": 1, \"page_size\": 50}}";
        
        String config9 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1006, \"rule_type_id\": 4, \"rule_type\": \"Map\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.Map.get(java.lang.Object)\", \"source\": \"O&R\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1007, \"rule_type_id\": 4, \"rule_type\": \"Map\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.Map.getOrDefault(java.lang.Object,java.lang.Object)\", \"source\": \"O&R\", \"target\": \"R\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1008, \"rule_type_id\": 4, \"rule_type\": \"Map\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.Map.put(java.lang.Object,java.lang.Object)\", \"source\": \"P1,2\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1009, \"rule_type_id\": 4, \"rule_type\": \"Map\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.Map.putAll(java.util.Map)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1010, \"rule_type_id\": 4, \"rule_type\": \"Map\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.util.Map.putIfAbsent(java.lang.Object,java.lang.Object)\", \"source\": \"P1,2\", \"target\": \"O\", \"inherit\": \"true\", \"track\": \"\", \"update_time\": 1610536827, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 5, \"num_pages\": 1, \"page_size\": 50}}";

        //IO传播
        String config10 ="{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1012, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.net.Socket.<init>(java.lang.String,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1013, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.net.Socket.getOutputStream()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1014, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.BufferedReader.<init>(java.io.Reader)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1015, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.BufferedReader.<init>(java.io.Reader,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1016, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.BufferedReader.<init>(java.io.FileReader)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1017, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.BufferedReader.<init>(java.io.InputStreamReader)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1018, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.BufferedReader.readLine()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1019, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.InputStreamReader.<init>(java.io.InputStream)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1020, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.InputStreamReader.<init>(java.io.InputStream,java.nio.charset.Charset)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1021, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.StringReader.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1022, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.FileInputStream.<init>(java.io.File)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1023, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.FileInputStream.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1024, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.FileReader.<init>(java.io.File)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1025, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.InputStreamReader.read(char[],int,int)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1026, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ByteArrayInputStream.<init>(byte[])\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1027, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ByteArrayInputStream.<init>(byte[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1028, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.InputStream.read(byte[],int,int)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1029, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.PushbackInputStream.<init>(java.io.InputStream,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1030, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.InputStream.<init>(java.io.InputStream)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1031, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ObjectInputStream.<init>(java.io.InputStream)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"all\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1032, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.CharArrayReader.<init>(char[])\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1033, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.CharArrayReader.<init>(char[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1034, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.CharArrayReader.read(char[],int,int)\", \"source\": \"O\", \"target\": \"P1\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1035, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ByteArrayOutputStream.write(byte[],int,int)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1036, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ByteArrayOutputStream.toByteArray()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1037, \"rule_type_id\": 14, \"rule_type\": \"IO\\u4f20\\u64ad\", \"value\": \"java.io.ByteArrayOutputStream.reset()\", \"source\": \"O\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 26, \"num_pages\": 1, \"page_size\": 50}}";
        
        //URI传播
        String config11 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1038, \"rule_type_id\": 15, \"rule_type\": \"URI\\u4f20\\u64ad\", \"value\": \"java.net.URI.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1039, \"rule_type_id\": 15, \"rule_type\": \"URI\\u4f20\\u64ad\", \"value\": \"java.net.URI.<init>(java.lang.String,java.lang.String,java.lang.String)\", \"source\": \"P1,2,3\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1040, \"rule_type_id\": 15, \"rule_type\": \"URI\\u4f20\\u64ad\", \"value\": \"java.net.URI.<init>(java.lang.String,java.lang.String,java.lang.String,java.lang.String,java.lang.String)\", \"source\": \"P2,3,4,5\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1041, \"rule_type_id\": 15, \"rule_type\": \"URI\\u4f20\\u64ad\", \"value\": \"java.net.URI.toURL()\", \"source\": \"O\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1042, \"rule_type_id\": 15, \"rule_type\": \"URI\\u4f20\\u64ad\", \"value\": \"org.apache.commons.httpclient.URI.parseUriReference(java.lang.String, boolean)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 5, \"num_pages\": 1, \"page_size\": 50}}";
        
        //URL类型传播
        String config12 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1043, \"rule_type_id\": 16, \"rule_type\": \"URL\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.net.URL.<init>(java.lang.String)\", \"source\": \"P1\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1044, \"rule_type_id\": 16, \"rule_type\": \"URL\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.net.URL.<init>(java.lang.String,java.lang.String,int,java.lang.String)\", \"source\": \"P1,2,4\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1045, \"rule_type_id\": 16, \"rule_type\": \"URL\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.net.URL.<init>(java.lang.String,java.lang.String,int,java.lang.String,java.net.URLStreamHandler)\", \"source\": \"P1,2,4\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1046, \"rule_type_id\": 16, \"rule_type\": \"URL\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.net.URL.<init>(java.lang.String,java.lang.String,java.lang.String)\", \"source\": \"P1,2,3\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1047, \"rule_type_id\": 16, \"rule_type\": \"URL\\u7c7b\\u578b\\u4f20\\u64ad\", \"value\": \"java.net.URL.<init>(java.net.URL,java.lang.String)\", \"source\": \"P1,2\", \"target\": \"O\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 5, \"num_pages\": 1, \"page_size\": 50}}";
        
        //URLDecoder传播
        String config13 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1048, \"rule_type_id\": 17, \"rule_type\": \"URLDecoder\\u4f20\\u64ad\", \"value\": \"java.net.URLDecoder.decode(java.lang.String,java.lang.String)\", \"source\": \"P1\", \"target\": \"R\", \"inherit\": \"false\", \"track\": \"\", \"update_time\": 1610536828, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 1, \"num_pages\": 1, \"page_size\": 50}}";
        
        List<MethodRule> result = new ArrayList<>();
        
        Map<Integer, List<String>> configMap = new HashMap<>();
        
        configMap.put(1, Arrays.asList(config, config6, config7));
        
        configMap.put(2, Arrays.asList(config2, config3));
        
        configMap.put(3, Arrays.asList(config4, config5,config8,config9));
    
        configMap.put(4, Arrays.asList(config10, config11,config12,config13));
        
        for (Map.Entry<Integer, List<String>> entry : configMap.entrySet()) {
            for (String conf : entry.getValue()) {
                realHandleConfig(entry.getKey(), conf, result, 60);
            }
        }
        System.out.println(SerializeUtils.serializeToString(result));
        String config80 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1195, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.DirContext.search(java.lang.String,java.lang.String,java.lang.Object[],javax.naming.directory.SearchControls)\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1196, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.DirContext.search(java.lang.String,java.lang.String,javax.naming.directory.SearchControls)\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1197, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.DirContext.search(java.lang.String,java.lang.String,javax.naming.directory.SearchControls\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1198, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.InitialDirContext.search(java.lang.String,java.lang.String,java.lang.Object[],javax.naming.directory.SearchControls)\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1199, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.InitialDirContext.search(java.lang.String,java.lang.String,javax.naming.directory.SearchControls)\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1200, \"rule_type_id\": 42, \"rule_type\": \"LDAP\\u6ce8\\u5165\", \"value\": \"javax.naming.directory.InitialDirContext.search(java.lang.String,java.lang.String,javax.naming.directory.SearchControls\", \"source\": \"P2\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536833, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 6, \"num_pages\": 1, \"page_size\": 30}}";
        
        String config90 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1324, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"javax.servlet.jsp.el.ExpressionEvaluator.evaluate(java.lang.String,java.lang.Class,javax.servlet.jsp.el.VariableResolver,javax.servlet.jsp.el.FunctionMapper)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1325, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.Object,java.util.Map,java.lang.Object)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1326, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.Object,java.util.Map,java.lang.Object,java.lang.Class)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1327, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.String,java.util.Map,java.lang.Object)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1328, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.String,java.util.Map,java.lang.Object,java.lang.Class)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1329, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.Object,java.lang.Object)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1330, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.Object,java.lang.Object,java.lang.Class)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1331, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.String,java.lang.Object)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1332, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"ognl.Ognl.getValue(java.lang.String,java.lang.Object,java.lang.Class)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1333, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.apache.commons.ognl.Ognl.parseExpression(java.lang.String)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"all\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1334, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue()\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536836, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1335, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(java.lang.Class)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1336, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(org.springframework.expression.EvaluationContext)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1337, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(org.springframework.expression.EvaluationContext,java.lang.Class)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1338, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(org.springframework.expression.EvaluationContext,java.lang.Object,java.lang.Class)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1339, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(org.springframework.expression.EvaluationContext,java.lang.Object)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1340, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(java.lang.Object)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1341, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValue(java.lang.Object,java.lang.Class)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1342, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValueTypeDescriptor(java.lang.Object)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1343, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValueTypeDescriptor()\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1344, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValueTypeDescriptor(org.springframework.expression.EvaluationContext,java.lang.Object)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}, {\"id\": 1345, \"rule_type_id\": 52, \"rule_type\": \"\\u8868\\u8fbe\\u5f0f\\u6ce8\\u5165\", \"value\": \"org.springframework.expression.Expression.getValueTypeDescriptor(org.springframework.expression.EvaluationContext)\", \"source\": \"O\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1610536837, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 22, \"num_pages\": 1, \"page_size\": 30}}";
        
        String config100 = "{\"status\": 201, \"msg\": \"success\", \"data\": [{\"id\": 1513, \"rule_type_id\": 358, \"rule_type\": \"JNDI\\u6ce8\\u5165\", \"value\": \"javax.naming.Context.lookup(java.lang.String)\", \"source\": \"P1\", \"target\": \"\", \"inherit\": \"true\", \"track\": \"true\", \"update_time\": 1641540990, \"enable\": 1, \"user\": \"admin\"}], \"page\": {\"alltotal\": 1, \"num_pages\": 1, \"page_size\": 30}}";
        
        List<MethodRule> result2 = new ArrayList<>();
        
        Map<Integer, List<String>> configMap2 = new HashMap<>();
        
        configMap2.put(60, Arrays.asList(config80, config90, config100));
        
        for (Map.Entry<Integer, List<String>> entry : configMap2.entrySet()) {
            for (String conf : entry.getValue()) {
                realHandleConfig(4, conf, result2, entry.getKey());
            }
        }
        System.out.println("sink配置-----");
        System.out.println(SerializeUtils.serializeToString(result2));
        
        List<MethodRule> result3 = new ArrayList<>();
        
        result3.add(new MethodRule(4, "java/lang/Runtime", "exec", null, "P1", null, 500));
        result3.add(new MethodRule(4, "java/lang/ProcessImpl", "start", null, "P1", null, 500));
        result3.add(new MethodRule(4, "java/lang/ProcessBuilder", "start", null, "P1", null, 500));
        result3.add(new MethodRule(4, "java/lang/System", "loadLibrary", null, "P1", null, 100));
        result3.add(new MethodRule(4, "java/lang/System", "load", null, "P1", null, 100));
        result3.add(new MethodRule(4, "java/lang/Runtime", "load", null, "P1", null, 100));
        result3.add(new MethodRule(4, "java/lang/ClassLoader", "defineClass", null, "P1", null, 200));
        result3.add(
                new MethodRule(4, "java/lang/invoke/MethodHandles/Lookup", "defineHiddenClass", null, "P1", null, 200));
        System.out.println("手工配置-----");
        System.out.println(SerializeUtils.serializeToString(result3));
    }
    
    
    private void realHandleConfig(Integer type, String config, List<MethodRule> result, int score) throws Exception {
        Map configMap2 = new ObjectMapper().readValue(config, Map.class);
        List<Map> data = (List<Map>) configMap2.get("data");
        
        for (Map obj : data) {
            String value = (String) obj.get("value");
            String source = (String) obj.get("source");
            String target = (String) obj.get("target");
            String methodInfo;
            String param;
            if (value.indexOf("(") == -1) {
                methodInfo = value;
                param = null;
            } else {
                methodInfo = value.substring(0, value.indexOf("("));
                if(value.indexOf(")")==-1){
                    param = value.substring(value.lastIndexOf("(") + 1);
                }else{
                    param = value.substring(value.lastIndexOf("(") + 1, value.indexOf(")"));
                }
            }
            String className = methodInfo.substring(0, methodInfo.lastIndexOf("."));
            String methodName = methodInfo.substring(methodInfo.lastIndexOf(".") + 1);
            
            MethodRule rule = new MethodRule();
            rule.setType(type);
            rule.setMethodName(methodName);
            rule.setClassName(className.replace('.', '/'));
            rule.setArgumentDescriptor(getArgumentDescriptor(param));
            rule.setSource(source);
            rule.setTarget(target);
            rule.setScore(score);
            result.add(rule);
        }
    }
    
    private static String getArgumentDescriptor(String param) {
        if(param==null){
            return null;
        }
        List<String> result = new ArrayList<>();
        String[] params = param.split(",");
        for (String s : params) {
            if ("int".equals(s)) {
                result.add("I");
            } else if ("byte".equals(s)) {
                result.add("B");
            } else if ("char".equals(s)) {
                result.add("C");
            } else if ("boolean".equals(s)) {
                result.add("Z");
            } else if ("double".equals(s)) {
                result.add("D");
            } else if ("float".equals(s)) {
                result.add("F");
            } else if ("short".equals(s)) {
                result.add("S");
            } else if ("long".equals(s)) {
                result.add("J");
            } else {
                s = s.replace('.', '/');
                if (s.endsWith("[]")) {
                    result.add("[" + s.substring(0, s.length() - 2) + ";");
                } else {
                    if (s.length() > 0) {
                        result.add("L" + s + ";");
                    }
                    
                }
            }
        }
        return "(" + String.join("", result) + ")";
    }
}
